<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The Talc Allocator!"><title>Talc in talc - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-ca0dd0c4.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="talc" data-themes="" data-resource-suffix="" data-rustdoc-version="1.92.0-nightly (2300c2aef 2025-10-12)" data-channel="nightly" data-search-js="search-8d3311b9.js" data-stringdex-js="stringdex-828709d0.js" data-settings-js="settings-c38705f0.js" ><script src="../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-ce535bd0.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc struct"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Talc</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../talc/index.html">talc</a><span class="version">4.4.3</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Talc</a></h2><h3><a href="#fields">Fields</a></h3><ul class="block structfield"><li><a href="#structfield.oom_handler" title="oom_handler">oom_handler</a></li></ul><h3><a href="#implementations">Methods</a></h3><ul class="block method"><li><a href="#method.claim" title="claim">claim</a></li><li><a href="#method.extend" title="extend">extend</a></li><li><a href="#method.free" title="free">free</a></li><li><a href="#method.get_allocated_span" title="get_allocated_span">get_allocated_span</a></li><li><a href="#method.grow" title="grow">grow</a></li><li><a href="#method.grow_in_place" title="grow_in_place">grow_in_place</a></li><li><a href="#method.lock" title="lock">lock</a></li><li><a href="#method.malloc" title="malloc">malloc</a></li><li><a href="#method.new" title="new">new</a></li><li><a href="#method.shrink" title="shrink">shrink</a></li><li><a href="#method.truncate" title="truncate">truncate</a></li></ul><h3><a href="#trait-implementations">Trait Implementations</a></h3><ul class="block trait-implementation"><li><a href="#impl-Debug-for-Talc%3CO%3E" title="Debug">Debug</a></li><li><a href="#impl-Send-for-Talc%3CO%3E" title="Send">Send</a></li></ul><h3><a href="#synthetic-implementations">Auto Trait Implementations</a></h3><ul class="block synthetic-implementation"><li><a href="#impl-Sync-for-Talc%3CO%3E" title="!Sync">!Sync</a></li><li><a href="#impl-Freeze-for-Talc%3CO%3E" title="Freeze">Freeze</a></li><li><a href="#impl-RefUnwindSafe-for-Talc%3CO%3E" title="RefUnwindSafe">RefUnwindSafe</a></li><li><a href="#impl-Unpin-for-Talc%3CO%3E" title="Unpin">Unpin</a></li><li><a href="#impl-UnwindSafe-for-Talc%3CO%3E" title="UnwindSafe">UnwindSafe</a></li></ul><h3><a href="#blanket-implementations">Blanket Implementations</a></h3><ul class="block blanket-implementation"><li><a href="#impl-Any-for-T" title="Any">Any</a></li><li><a href="#impl-Borrow%3CT%3E-for-T" title="Borrow&#60;T&#62;">Borrow&#60;T&#62;</a></li><li><a href="#impl-BorrowMut%3CT%3E-for-T" title="BorrowMut&#60;T&#62;">BorrowMut&#60;T&#62;</a></li><li><a href="#impl-From%3CT%3E-for-T" title="From&#60;T&#62;">From&#60;T&#62;</a></li><li><a href="#impl-Into%3CU%3E-for-T" title="Into&#60;U&#62;">Into&#60;U&#62;</a></li><li><a href="#impl-TryFrom%3CU%3E-for-T" title="TryFrom&#60;U&#62;">TryFrom&#60;U&#62;</a></li><li><a href="#impl-TryInto%3CU%3E-for-T" title="TryInto&#60;U&#62;">TryInto&#60;U&#62;</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="index.html">In crate talc</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="index.html">talc</a></div><h1>Struct <span class="struct">Talc</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/talc/talc.rs.html#203-219">Source</a> </span></div><pre class="rust item-decl"><code>pub struct Talc&lt;O: <a class="trait" href="trait.OomHandler.html" title="trait talc::OomHandler">OomHandler</a>&gt; {
    pub oom_handler: O,
    <span class="comment">/* private fields */</span>
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>The Talc Allocator!</p>
<p>One way to get started:</p>
<ol>
<li>Construct with <a href="struct.Talc.html#method.new" title="associated function talc::Talc::new"><code>new</code></a> (supply [<code>ErrOnOom</code>] to ignore OOM handling).</li>
<li>Establish any number of heaps with <a href="struct.Talc.html#method.claim" title="method talc::Talc::claim"><code>claim</code></a>.</li>
<li>Call <a href="struct.Talc.html#method.lock" title="method talc::Talc::lock"><code>lock</code></a> to get a [<code>Talck</code>] which supports the
<a href="https://doc.rust-lang.org/nightly/core/alloc/global/trait.GlobalAlloc.html" title="trait core::alloc::global::GlobalAlloc"><code>GlobalAlloc</code></a> and <a href="https://doc.rust-lang.org/nightly/core/alloc/trait.Allocator.html" title="trait core::alloc::Allocator"><code>Allocator</code></a> traits.</li>
</ol>
<p>Check out the associated functions <code>new</code>, <code>claim</code>, <code>lock</code>, <code>extend</code>, and <code>truncate</code>.</p>
</div></details><h2 id="fields" class="fields section-header">Fields<a href="#fields" class="anchor">§</a></h2><span id="structfield.oom_handler" class="structfield section-header"><a href="#structfield.oom_handler" class="anchor field">§</a><code>oom_handler: O</code></span><div class="docblock"><p>The user-specified OOM handler.</p>
<p>Its state is entirely maintained by the user.</p>
</div><h2 id="implementations" class="section-header">Implementations<a href="#implementations" class="anchor">§</a></h2><div id="implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-Talc%3CO%3E" class="impl"><a class="src rightside" href="../src/talc/talc.rs.html#233-1056">Source</a><a href="#impl-Talc%3CO%3E" class="anchor">§</a><h3 class="code-header">impl&lt;O: <a class="trait" href="trait.OomHandler.html" title="trait talc::OomHandler">OomHandler</a>&gt; <a class="struct" href="struct.Talc.html" title="struct talc::Talc">Talc</a>&lt;O&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.malloc" class="method"><a class="src rightside" href="../src/talc/talc.rs.html#327-374">Source</a><h4 class="code-header">pub unsafe fn <a href="#method.malloc" class="fn">malloc</a>(&amp;mut self, layout: <a class="struct" href="https://doc.rust-lang.org/nightly/core/alloc/layout/struct.Layout.html" title="struct core::alloc::layout::Layout">Layout</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/core/ptr/non_null/struct.NonNull.html" title="struct core::ptr::non_null::NonNull">NonNull</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u8.html">u8</a>&gt;, <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Allocate a contiguous region of memory according to <code>layout</code>, if possible.</p>
<h5 id="safety"><a class="doc-anchor" href="#safety">§</a>Safety</h5>
<p><code>layout.size()</code> must be nonzero.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.free" class="method"><a class="src rightside" href="../src/talc/talc.rs.html#463-495">Source</a><h4 class="code-header">pub unsafe fn <a href="#method.free" class="fn">free</a>(&amp;mut self, ptr: <a class="struct" href="https://doc.rust-lang.org/nightly/core/ptr/non_null/struct.NonNull.html" title="struct core::ptr::non_null::NonNull">NonNull</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u8.html">u8</a>&gt;, layout: <a class="struct" href="https://doc.rust-lang.org/nightly/core/alloc/layout/struct.Layout.html" title="struct core::alloc::layout::Layout">Layout</a>)</h4></section></summary><div class="docblock"><p>Free previously allocated/reallocated memory.</p>
<h5 id="safety-1"><a class="doc-anchor" href="#safety-1">§</a>Safety</h5>
<p><code>ptr</code> must have been previously allocated given <code>layout</code>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.grow" class="method"><a class="src rightside" href="../src/talc/talc.rs.html#501-519">Source</a><h4 class="code-header">pub unsafe fn <a href="#method.grow" class="fn">grow</a>(
    &amp;mut self,
    ptr: <a class="struct" href="https://doc.rust-lang.org/nightly/core/ptr/non_null/struct.NonNull.html" title="struct core::ptr::non_null::NonNull">NonNull</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u8.html">u8</a>&gt;,
    old_layout: <a class="struct" href="https://doc.rust-lang.org/nightly/core/alloc/layout/struct.Layout.html" title="struct core::alloc::layout::Layout">Layout</a>,
    new_size: <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>,
) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/core/ptr/non_null/struct.NonNull.html" title="struct core::ptr::non_null::NonNull">NonNull</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u8.html">u8</a>&gt;, <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Grow a previously allocated/reallocated region of memory to <code>new_size</code>.</p>
<h5 id="safety-2"><a class="doc-anchor" href="#safety-2">§</a>Safety</h5>
<p><code>ptr</code> must have been previously allocated or reallocated given <code>layout</code>.
<code>new_size</code> must be larger or equal to <code>layout.size()</code>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.grow_in_place" class="method"><a class="src rightside" href="../src/talc/talc.rs.html#528-604">Source</a><h4 class="code-header">pub unsafe fn <a href="#method.grow_in_place" class="fn">grow_in_place</a>(
    &amp;mut self,
    ptr: <a class="struct" href="https://doc.rust-lang.org/nightly/core/ptr/non_null/struct.NonNull.html" title="struct core::ptr::non_null::NonNull">NonNull</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u8.html">u8</a>&gt;,
    old_layout: <a class="struct" href="https://doc.rust-lang.org/nightly/core/alloc/layout/struct.Layout.html" title="struct core::alloc::layout::Layout">Layout</a>,
    new_size: <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>,
) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/core/ptr/non_null/struct.NonNull.html" title="struct core::ptr::non_null::NonNull">NonNull</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u8.html">u8</a>&gt;, <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Attempt to grow a previously allocated/reallocated region of memory to <code>new_size</code>.</p>
<p>Returns <code>Err</code> if reallocation could not occur in-place.
Ownership of the memory remains with the caller.</p>
<h5 id="safety-3"><a class="doc-anchor" href="#safety-3">§</a>Safety</h5>
<p><code>ptr</code> must have been previously allocated or reallocated given <code>layout</code>.
<code>new_size</code> must be larger or equal to <code>layout.size()</code>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.shrink" class="method"><a class="src rightside" href="../src/talc/talc.rs.html#615-656">Source</a><h4 class="code-header">pub unsafe fn <a href="#method.shrink" class="fn">shrink</a>(
    &amp;mut self,
    ptr: <a class="struct" href="https://doc.rust-lang.org/nightly/core/ptr/non_null/struct.NonNull.html" title="struct core::ptr::non_null::NonNull">NonNull</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u8.html">u8</a>&gt;,
    layout: <a class="struct" href="https://doc.rust-lang.org/nightly/core/alloc/layout/struct.Layout.html" title="struct core::alloc::layout::Layout">Layout</a>,
    new_size: <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>,
)</h4></section></summary><div class="docblock"><p>Shrink a previously allocated/reallocated region of memory to <code>new_size</code>.</p>
<p>This function is infallible given valid inputs, and the reallocation will always be
done in-place, maintaining the validity of the pointer.</p>
<h5 id="safety-4"><a class="doc-anchor" href="#safety-4">§</a>Safety</h5>
<ul>
<li><code>ptr</code> must have been previously allocated or reallocated given <code>layout</code>.</li>
<li><code>new_size</code> must be smaller or equal to <code>layout.size()</code>.</li>
<li><code>new_size</code> should be nonzero.</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="method.new" class="method"><a class="src rightside" href="../src/talc/talc.rs.html#663-673">Source</a><h4 class="code-header">pub const fn <a href="#method.new" class="fn">new</a>(oom_handler: O) -&gt; Self</h4></section></summary><div class="docblock"><p>Returns an uninitialized <a href="struct.Talc.html" title="struct talc::Talc"><code>Talc</code></a>.</p>
<p>If you don’t want to handle OOM, use [<code>ErrOnOom</code>].</p>
<p>In order to make this allocator useful, <code>claim</code> some memory.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.get_allocated_span" class="method"><a class="src rightside" href="../src/talc/talc.rs.html#678-696">Source</a><h4 class="code-header">pub unsafe fn <a href="#method.get_allocated_span" class="fn">get_allocated_span</a>(&amp;self, heap: <a class="struct" href="struct.Span.html" title="struct talc::Span">Span</a>) -&gt; <a class="struct" href="struct.Span.html" title="struct talc::Span">Span</a></h4></section></summary><div class="docblock"><p>Returns the minimum <a href="struct.Span.html" title="struct talc::Span"><code>Span</code></a> containing this heap’s allocated memory.</p>
<h5 id="safety-5"><a class="doc-anchor" href="#safety-5">§</a>Safety</h5>
<p><code>heap</code> must be the return value of a heap manipulation function.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.claim" class="method"><a class="src rightside" href="../src/talc/talc.rs.html#723-802">Source</a><h4 class="code-header">pub unsafe fn <a href="#method.claim" class="fn">claim</a>(&amp;mut self, memory: <a class="struct" href="struct.Span.html" title="struct talc::Span">Span</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="struct.Span.html" title="struct talc::Span">Span</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Attempt to initialize a new heap for the allocator.</p>
<p>Note:</p>
<ul>
<li>Each heap reserves a <code>usize</code> at the bottom as fixed overhead.</li>
<li>Metadata will be placed into the bottom of the first successfully established heap.
It is currently ~1KiB on 64-bit systems (less on 32-bit). This is subject to change.</li>
</ul>
<h5 id="return-values"><a class="doc-anchor" href="#return-values">§</a>Return Values</h5>
<p>The resulting <a href="struct.Span.html" title="struct talc::Span"><code>Span</code></a> is the actual heap extent, and may
be slightly smaller than requested. Use this to resize the heap.
Any memory outside the claimed heap is free to use.</p>
<p>Returns <a href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html#variant.Err" title="variant core::result::Result::Err"><code>Err</code></a> where</p>
<ul>
<li>allocator metadata is not yet established, and there’s insufficient memory to do so.</li>
<li>allocator metadata is established, but the heap is too small
(less than around <code>4 * usize</code> for now).</li>
</ul>
<h5 id="safety-6"><a class="doc-anchor" href="#safety-6">§</a>Safety</h5>
<ul>
<li>The memory within the <code>memory</code> must be valid for reads and writes,
and memory therein (when not allocated to the user) must not be mutated
while the allocator is in use.</li>
<li><code>memory</code> should not overlap with any other active heap.</li>
</ul>
<h5 id="panics"><a class="doc-anchor" href="#panics">§</a>Panics</h5>
<p>Panics if <code>memory</code> contains the null address.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.extend" class="method"><a class="src rightside" href="../src/talc/talc.rs.html#833-880">Source</a><h4 class="code-header">pub unsafe fn <a href="#method.extend" class="fn">extend</a>(&amp;mut self, old_heap: <a class="struct" href="struct.Span.html" title="struct talc::Span">Span</a>, req_heap: <a class="struct" href="struct.Span.html" title="struct talc::Span">Span</a>) -&gt; <a class="struct" href="struct.Span.html" title="struct talc::Span">Span</a></h4></section></summary><div class="docblock"><p>Increase the extent of a heap. The new extent of the heap is returned,
and will be equal to or slightly smaller than requested.</p>
<h5 id="safety-7"><a class="doc-anchor" href="#safety-7">§</a>Safety</h5>
<ul>
<li><code>old_heap</code> must be the return value of a heap-manipulation function
of this allocator instance.</li>
<li>The entire <code>req_heap</code> memory but be readable and writable
and unmutated besides that which is allocated so long as the heap is in use.</li>
</ul>
<h5 id="panics-1"><a class="doc-anchor" href="#panics-1">§</a>Panics</h5>
<p>This function panics if:</p>
<ul>
<li><code>old_heap</code> is too small or heap metadata is not yet allocated</li>
<li><code>req_heap</code> doesn’t contain <code>old_heap</code></li>
<li><code>req_heap</code> contains the null address</li>
</ul>
<p>A recommended pattern for satisfying these criteria is:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span><span class="kw-2">mut </span>heap = [<span class="number">0u8</span>; <span class="number">2000</span>];
<span class="kw">let </span>old_heap = Span::from(<span class="kw-2">&amp;mut </span>heap[<span class="number">300</span>..<span class="number">1700</span>]);
<span class="kw">let </span>old_heap = <span class="kw">unsafe </span>{ talc.claim(old_heap).unwrap() };

<span class="comment">// compute the new heap span as an extension of the old span
</span><span class="kw">let </span>new_heap = old_heap.extend(<span class="number">250</span>, <span class="number">500</span>).fit_within((<span class="kw-2">&amp;mut </span>heap[..]).into());

<span class="comment">// SAFETY: be sure not to extend into memory we can't use
</span><span class="kw">let </span>new_heap = <span class="kw">unsafe </span>{ talc.extend(old_heap, new_heap) };</code></pre></div></div></details><details class="toggle method-toggle" open><summary><section id="method.truncate" class="method"><a class="src rightside" href="../src/talc/talc.rs.html#926-999">Source</a><h4 class="code-header">pub unsafe fn <a href="#method.truncate" class="fn">truncate</a>(&amp;mut self, old_heap: <a class="struct" href="struct.Span.html" title="struct talc::Span">Span</a>, req_heap: <a class="struct" href="struct.Span.html" title="struct talc::Span">Span</a>) -&gt; <a class="struct" href="struct.Span.html" title="struct talc::Span">Span</a></h4></section></summary><div class="docblock"><p>Reduce the extent of a heap.
The new extent must encompass all current allocations. See below.</p>
<p>The resultant heap is always equal to or slightly smaller than <code>req_heap</code>.</p>
<p>Truncating to an empty <a href="struct.Span.html" title="struct talc::Span"><code>Span</code></a> is valid for heaps where no memory is
currently allocated within it.</p>
<p>In all cases where the return value is empty, the heap no longer exists.
You may do what you like with the heap memory. The empty span should not be
used as input to <a href="struct.Talc.html#method.truncate" title="method talc::Talc::truncate"><code>truncate</code></a>, <a href="struct.Talc.html#method.extend" title="method talc::Talc::extend"><code>extend</code></a>,
or <a href="struct.Talc.html#method.get_allocated_span" title="method talc::Talc::get_allocated_span"><code>get_allocated_span</code></a>.</p>
<h5 id="safety-8"><a class="doc-anchor" href="#safety-8">§</a>Safety</h5>
<p><code>old_heap</code> must be the return value of a heap-manipulation function
of this allocator instance.</p>
<h5 id="panics-2"><a class="doc-anchor" href="#panics-2">§</a>Panics:</h5>
<p>This function panics if:</p>
<ul>
<li><code>old_heap</code> doesn’t contain <code>req_heap</code></li>
<li><code>req_heap</code> doesn’t contain all the allocated memory in <code>old_heap</code></li>
<li>the heap metadata is not yet allocated, see <a href="struct.Talc.html#method.claim" title="method talc::Talc::claim"><code>claim</code></a></li>
</ul>
<h5 id="usage"><a class="doc-anchor" href="#usage">§</a>Usage</h5>
<p>A recommended pattern for satisfying these criteria is:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span><span class="kw-2">mut </span>heap = [<span class="number">0u8</span>; <span class="number">2000</span>];
<span class="kw">let </span>old_heap = Span::from(<span class="kw-2">&amp;mut </span>heap[<span class="number">300</span>..<span class="number">1700</span>]);
<span class="kw">let </span>old_heap = <span class="kw">unsafe </span>{ talc.claim(old_heap).unwrap() };

<span class="comment">// note: lock a `Talck` here otherwise a race condition may occur
// in between Talc::get_allocated_span and Talc::truncate

// compute the new heap span as a truncation of the old span
</span><span class="kw">let </span>new_heap = old_heap
    .truncate(<span class="number">250</span>, <span class="number">300</span>)
    .fit_over(<span class="kw">unsafe </span>{ talc.get_allocated_span(old_heap) });

<span class="comment">// truncate the heap
</span><span class="kw">unsafe </span>{ talc.truncate(old_heap, new_heap); }</code></pre></div></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Talc%3CO%3E-1" class="impl"><a class="src rightside" href="../src/talc/talck.rs.html#227-248">Source</a><a href="#impl-Talc%3CO%3E-1" class="anchor">§</a><h3 class="code-header">impl&lt;O: <a class="trait" href="trait.OomHandler.html" title="trait talc::OomHandler">OomHandler</a>&gt; <a class="struct" href="struct.Talc.html" title="struct talc::Talc">Talc</a>&lt;O&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.lock" class="method"><a class="src rightside" href="../src/talc/talck.rs.html#245-247">Source</a><h4 class="code-header">pub const fn <a href="#method.lock" class="fn">lock</a>&lt;R: <a class="trait" href="../lock_api/mutex/trait.RawMutex.html" title="trait lock_api::mutex::RawMutex">RawMutex</a>&gt;(self) -&gt; <a class="struct" href="struct.Talck.html" title="struct talc::Talck">Talck</a>&lt;R, O&gt;</h4></section></summary><div class="docblock"><p>Wrap in <code>Talck</code>, a mutex-locked wrapper struct using <a href="../lock_api/index.html" title="mod lock_api"><code>lock_api</code></a>.</p>
<p>This implements the <a href="https://doc.rust-lang.org/nightly/core/alloc/global/trait.GlobalAlloc.html" title="trait core::alloc::global::GlobalAlloc"><code>GlobalAlloc</code></a> trait and provides
access to the <a href="https://doc.rust-lang.org/nightly/core/alloc/trait.Allocator.html" title="trait core::alloc::Allocator"><code>Allocator</code></a> API.</p>
<h5 id="examples"><a class="doc-anchor" href="#examples">§</a>Examples</h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>spin::Mutex;
<span class="kw">let </span>talc = Talc::new(ErrOnOom);
<span class="kw">let </span>talck = talc.lock::&lt;Mutex&lt;()&gt;&gt;();

<span class="kw">unsafe </span>{
    talck.alloc(Layout::from_size_align_unchecked(<span class="number">32</span>, <span class="number">4</span>));
}</code></pre></div></div></details></div></details></div><h2 id="trait-implementations" class="section-header">Trait Implementations<a href="#trait-implementations" class="anchor">§</a></h2><div id="trait-implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-Debug-for-Talc%3CO%3E" class="impl"><a class="src rightside" href="../src/talc/talc.rs.html#223-231">Source</a><a href="#impl-Debug-for-Talc%3CO%3E" class="anchor">§</a><h3 class="code-header">impl&lt;O: <a class="trait" href="trait.OomHandler.html" title="trait talc::OomHandler">OomHandler</a>&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> for <a class="struct" href="struct.Talc.html" title="struct talc::Talc">Talc</a>&lt;O&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.fmt" class="method trait-impl"><a class="src rightside" href="../src/talc/talc.rs.html#224-230">Source</a><a href="#method.fmt" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html#tymethod.fmt" class="fn">fmt</a>(&amp;self, f: &amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/core/fmt/struct.Formatter.html" title="struct core::fmt::Formatter">Formatter</a>&lt;'_&gt;) -&gt; <a class="type" href="https://doc.rust-lang.org/nightly/core/fmt/type.Result.html" title="type core::fmt::Result">Result</a></h4></section></summary><div class='docblock'>Formats the value using the given formatter. <a href="https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html#tymethod.fmt">Read more</a></div></details></div></details><section id="impl-Send-for-Talc%3CO%3E" class="impl"><a class="src rightside" href="../src/talc/talc.rs.html#221">Source</a><a href="#impl-Send-for-Talc%3CO%3E" class="anchor">§</a><h3 class="code-header">impl&lt;O: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="trait.OomHandler.html" title="trait talc::OomHandler">OomHandler</a>&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> for <a class="struct" href="struct.Talc.html" title="struct talc::Talc">Talc</a>&lt;O&gt;</h3></section></div><h2 id="synthetic-implementations" class="section-header">Auto Trait Implementations<a href="#synthetic-implementations" class="anchor">§</a></h2><div id="synthetic-implementations-list"><section id="impl-Freeze-for-Talc%3CO%3E" class="impl"><a href="#impl-Freeze-for-Talc%3CO%3E" class="anchor">§</a><h3 class="code-header">impl&lt;O&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Freeze.html" title="trait core::marker::Freeze">Freeze</a> for <a class="struct" href="struct.Talc.html" title="struct talc::Talc">Talc</a>&lt;O&gt;<div class="where">where
    O: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Freeze.html" title="trait core::marker::Freeze">Freeze</a>,</div></h3></section><section id="impl-RefUnwindSafe-for-Talc%3CO%3E" class="impl"><a href="#impl-RefUnwindSafe-for-Talc%3CO%3E" class="anchor">§</a><h3 class="code-header">impl&lt;O&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/panic/unwind_safe/trait.RefUnwindSafe.html" title="trait core::panic::unwind_safe::RefUnwindSafe">RefUnwindSafe</a> for <a class="struct" href="struct.Talc.html" title="struct talc::Talc">Talc</a>&lt;O&gt;<div class="where">where
    O: <a class="trait" href="https://doc.rust-lang.org/nightly/core/panic/unwind_safe/trait.RefUnwindSafe.html" title="trait core::panic::unwind_safe::RefUnwindSafe">RefUnwindSafe</a>,</div></h3></section><section id="impl-Sync-for-Talc%3CO%3E" class="impl"><a href="#impl-Sync-for-Talc%3CO%3E" class="anchor">§</a><h3 class="code-header">impl&lt;O&gt; !<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> for <a class="struct" href="struct.Talc.html" title="struct talc::Talc">Talc</a>&lt;O&gt;</h3></section><section id="impl-Unpin-for-Talc%3CO%3E" class="impl"><a href="#impl-Unpin-for-Talc%3CO%3E" class="anchor">§</a><h3 class="code-header">impl&lt;O&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a> for <a class="struct" href="struct.Talc.html" title="struct talc::Talc">Talc</a>&lt;O&gt;<div class="where">where
    O: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a>,</div></h3></section><section id="impl-UnwindSafe-for-Talc%3CO%3E" class="impl"><a href="#impl-UnwindSafe-for-Talc%3CO%3E" class="anchor">§</a><h3 class="code-header">impl&lt;O&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/panic/unwind_safe/trait.UnwindSafe.html" title="trait core::panic::unwind_safe::UnwindSafe">UnwindSafe</a> for <a class="struct" href="struct.Talc.html" title="struct talc::Talc">Talc</a>&lt;O&gt;<div class="where">where
    O: <a class="trait" href="https://doc.rust-lang.org/nightly/core/panic/unwind_safe/trait.UnwindSafe.html" title="trait core::panic::unwind_safe::UnwindSafe">UnwindSafe</a>,</div></h3></section></div><h2 id="blanket-implementations" class="section-header">Blanket Implementations<a href="#blanket-implementations" class="anchor">§</a></h2><div id="blanket-implementations-list"><details class="toggle implementors-toggle"><summary><section id="impl-Any-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/any.rs.html#138">Source</a><a href="#impl-Any-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html" title="trait core::any::Any">Any</a> for T<div class="where">where
    T: 'static + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.type_id" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/any.rs.html#139">Source</a><a href="#method.type_id" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html#tymethod.type_id" class="fn">type_id</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/any/struct.TypeId.html" title="struct core::any::TypeId">TypeId</a></h4></section></summary><div class='docblock'>Gets the <code>TypeId</code> of <code>self</code>. <a href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html#tymethod.type_id">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Borrow%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#212">Source</a><a href="#impl-Borrow%3CT%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a>&lt;T&gt; for T<div class="where">where
    T: ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.borrow" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#214">Source</a><a href="#method.borrow" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html#tymethod.borrow" class="fn">borrow</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.reference.html">&amp;T</a></h4></section></summary><div class='docblock'>Immutably borrows from an owned value. <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html#tymethod.borrow">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-BorrowMut%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#221">Source</a><a href="#impl-BorrowMut%3CT%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html" title="trait core::borrow::BorrowMut">BorrowMut</a>&lt;T&gt; for T<div class="where">where
    T: ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.borrow_mut" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#222">Source</a><a href="#method.borrow_mut" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut" class="fn">borrow_mut</a>(&amp;mut self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.reference.html">&amp;mut T</a></h4></section></summary><div class='docblock'>Mutably borrows from an owned value. <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-From%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#785">Source</a><a href="#impl-From%3CT%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for T</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#788">Source</a><a href="#method.from" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html#tymethod.from" class="fn">from</a>(t: T) -&gt; T</h4></section></summary><div class="docblock"><p>Returns the argument unchanged.</p>
</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Into%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#767-769">Source</a><a href="#impl-Into%3CU%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;U&gt; for T<div class="where">where
    U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt;,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.into" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#777">Source</a><a href="#method.into" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html#tymethod.into" class="fn">into</a>(self) -&gt; U</h4></section></summary><div class="docblock"><p>Calls <code>U::from(self)</code>.</p>
<p>That is, this conversion is whatever the implementation of
<code><a href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for U</code> chooses to do.</p>
</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-TryFrom%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#827-829">Source</a><a href="#impl-TryFrom%3CU%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt; for T<div class="where">where
    U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;T&gt;,</div></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Error-1" class="associatedtype trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#831">Source</a><a href="#associatedtype.Error-1" class="anchor">§</a><h4 class="code-header">type <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" class="associatedtype">Error</a> = <a class="enum" href="https://doc.rust-lang.org/nightly/core/convert/enum.Infallible.html" title="enum core::convert::Infallible">Infallible</a></h4></section></summary><div class='docblock'>The type returned in the event of a conversion error.</div></details><details class="toggle method-toggle" open><summary><section id="method.try_from" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#834">Source</a><a href="#method.try_from" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#tymethod.try_from" class="fn">try_from</a>(value: U) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;T, &lt;T as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>Performs the conversion.</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-TryInto%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#811-813">Source</a><a href="#impl-TryInto%3CU%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html" title="trait core::convert::TryInto">TryInto</a>&lt;U&gt; for T<div class="where">where
    U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;,</div></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Error" class="associatedtype trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#815">Source</a><a href="#associatedtype.Error" class="anchor">§</a><h4 class="code-header">type <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html#associatedtype.Error" class="associatedtype">Error</a> = &lt;U as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a></h4></section></summary><div class='docblock'>The type returned in the event of a conversion error.</div></details><details class="toggle method-toggle" open><summary><section id="method.try_into" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#818">Source</a><a href="#method.try_into" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html#tymethod.try_into" class="fn">try_into</a>(self) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;U, &lt;U as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>Performs the conversion.</div></details></div></details></div></section></div></main></body></html>